{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 177,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "from sklearn.ensemble import GradientBoostingClassifier\n",
    "from sklearn.metrics import classification_report\n",
    "from matplotlib import pyplot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [],
   "source": [
    "names = pd.read_csv('C:/Users/Daniel/Documents/StageDaniel/data/Polish_demodata/FeatureNames.csv', squeeze=True)\n",
    "year1 = pd.read_csv('C:/Users/Daniel/Documents/StageDaniel/data/Polish_demodata/1year.csv')\n",
    "year2 = pd.read_csv('C:/Users/Daniel/Documents/StageDaniel/data/Polish_demodata/2year.csv')\n",
    "year3 = pd.read_csv('C:/Users/Daniel/Documents/StageDaniel/data/Polish_demodata/3year.csv')\n",
    "year4 = pd.read_csv('C:/Users/Daniel/Documents/StageDaniel/data/Polish_demodata/4year.csv')\n",
    "year5 = pd.read_csv('C:/Users/Daniel/Documents/StageDaniel/data/Polish_demodata/5year.csv')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {},
   "outputs": [],
   "source": [
    "data = pd.concat([year1,year2,year3,year4,year5])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(43405, 67)"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.shape\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>X01_net_profit_div_total_assets</th>\n",
       "      <th>X02_total_liabilities_div_total_assets</th>\n",
       "      <th>X03_working_capital_div_total_assets</th>\n",
       "      <th>X04_current_assets_div_shortterm_liabilities</th>\n",
       "      <th>X05_cash_plus_shortterm_securities_plus_receivables_minus_shortterm_liabilities_div_operating_expenses_minus_depreciation__times_365</th>\n",
       "      <th>X06_retained_earnings_div_total_assets</th>\n",
       "      <th>X07_EBIT_div_total_assets</th>\n",
       "      <th>X08_book_value_of_equity_div_total_liabilities</th>\n",
       "      <th>X09_sales_div_total_assets</th>\n",
       "      <th>X10_equity_div_total_assets</th>\n",
       "      <th>...</th>\n",
       "      <th>X56__sales_minus_cost_of_products_sold__div_sales</th>\n",
       "      <th>X57__current_assets_minus_inventory_minus_shortterm_liabilities__div__sales_minus_gross_profit_minus_depreciation_</th>\n",
       "      <th>X58_total_costs_div_total_sales</th>\n",
       "      <th>X59_longterm_liabilities_div_equity</th>\n",
       "      <th>X60_sales_div_inventory</th>\n",
       "      <th>X61_sales_div_receivables</th>\n",
       "      <th>X62__shortterm_liabilities_times_365__div_sales</th>\n",
       "      <th>X63_sales_div_shortterm_liabilities</th>\n",
       "      <th>X64_sales_div_fixed_assets</th>\n",
       "      <th>Y_bankrupt</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.200550</td>\n",
       "      <td>0.37951</td>\n",
       "      <td>0.396410</td>\n",
       "      <td>2.04720</td>\n",
       "      <td>32.3510</td>\n",
       "      <td>0.38825</td>\n",
       "      <td>0.249760</td>\n",
       "      <td>1.33050</td>\n",
       "      <td>1.13890</td>\n",
       "      <td>0.504940</td>\n",
       "      <td>...</td>\n",
       "      <td>0.121960</td>\n",
       "      <td>0.397180</td>\n",
       "      <td>0.87804</td>\n",
       "      <td>0.001924</td>\n",
       "      <td>8.4160</td>\n",
       "      <td>5.1372</td>\n",
       "      <td>82.658</td>\n",
       "      <td>4.4158</td>\n",
       "      <td>7.42770</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.209120</td>\n",
       "      <td>0.49988</td>\n",
       "      <td>0.472250</td>\n",
       "      <td>1.94470</td>\n",
       "      <td>14.7860</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.258340</td>\n",
       "      <td>0.99601</td>\n",
       "      <td>1.69960</td>\n",
       "      <td>0.497880</td>\n",
       "      <td>...</td>\n",
       "      <td>0.121300</td>\n",
       "      <td>0.420020</td>\n",
       "      <td>0.85300</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>4.1486</td>\n",
       "      <td>3.2732</td>\n",
       "      <td>107.350</td>\n",
       "      <td>3.4000</td>\n",
       "      <td>60.98700</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.248660</td>\n",
       "      <td>0.69592</td>\n",
       "      <td>0.267130</td>\n",
       "      <td>1.55480</td>\n",
       "      <td>-1.1523</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.309060</td>\n",
       "      <td>0.43695</td>\n",
       "      <td>1.30900</td>\n",
       "      <td>0.304080</td>\n",
       "      <td>...</td>\n",
       "      <td>0.241140</td>\n",
       "      <td>0.817740</td>\n",
       "      <td>0.76599</td>\n",
       "      <td>0.694840</td>\n",
       "      <td>4.9909</td>\n",
       "      <td>3.9510</td>\n",
       "      <td>134.270</td>\n",
       "      <td>2.7185</td>\n",
       "      <td>5.20780</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.081483</td>\n",
       "      <td>0.30734</td>\n",
       "      <td>0.458790</td>\n",
       "      <td>2.49280</td>\n",
       "      <td>51.9520</td>\n",
       "      <td>0.14988</td>\n",
       "      <td>0.092704</td>\n",
       "      <td>1.86610</td>\n",
       "      <td>1.05710</td>\n",
       "      <td>0.573530</td>\n",
       "      <td>...</td>\n",
       "      <td>0.054015</td>\n",
       "      <td>0.142070</td>\n",
       "      <td>0.94598</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>4.5746</td>\n",
       "      <td>3.6147</td>\n",
       "      <td>86.435</td>\n",
       "      <td>4.2228</td>\n",
       "      <td>5.54970</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.187320</td>\n",
       "      <td>0.61323</td>\n",
       "      <td>0.229600</td>\n",
       "      <td>1.40630</td>\n",
       "      <td>-7.3128</td>\n",
       "      <td>0.18732</td>\n",
       "      <td>0.187320</td>\n",
       "      <td>0.63070</td>\n",
       "      <td>1.15590</td>\n",
       "      <td>0.386770</td>\n",
       "      <td>...</td>\n",
       "      <td>0.134850</td>\n",
       "      <td>0.484310</td>\n",
       "      <td>0.86515</td>\n",
       "      <td>0.124440</td>\n",
       "      <td>6.3985</td>\n",
       "      <td>4.3158</td>\n",
       "      <td>127.210</td>\n",
       "      <td>2.8692</td>\n",
       "      <td>7.89800</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5905</th>\n",
       "      <td>0.012898</td>\n",
       "      <td>0.70621</td>\n",
       "      <td>0.038857</td>\n",
       "      <td>1.17220</td>\n",
       "      <td>-18.9070</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.013981</td>\n",
       "      <td>0.41600</td>\n",
       "      <td>1.67680</td>\n",
       "      <td>0.293790</td>\n",
       "      <td>...</td>\n",
       "      <td>0.020169</td>\n",
       "      <td>0.043904</td>\n",
       "      <td>1.01220</td>\n",
       "      <td>1.259400</td>\n",
       "      <td>13.4720</td>\n",
       "      <td>12.4320</td>\n",
       "      <td>49.117</td>\n",
       "      <td>7.4313</td>\n",
       "      <td>2.27990</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5906</th>\n",
       "      <td>-0.578050</td>\n",
       "      <td>0.96702</td>\n",
       "      <td>-0.800850</td>\n",
       "      <td>0.16576</td>\n",
       "      <td>-67.3650</td>\n",
       "      <td>-0.57805</td>\n",
       "      <td>-0.578050</td>\n",
       "      <td>-0.40334</td>\n",
       "      <td>0.93979</td>\n",
       "      <td>-0.390040</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.064073</td>\n",
       "      <td>1.482000</td>\n",
       "      <td>1.06410</td>\n",
       "      <td>-0.018084</td>\n",
       "      <td>110.7200</td>\n",
       "      <td>44.7590</td>\n",
       "      <td>81.220</td>\n",
       "      <td>4.4940</td>\n",
       "      <td>5.13050</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5907</th>\n",
       "      <td>-0.179050</td>\n",
       "      <td>1.25530</td>\n",
       "      <td>-0.275990</td>\n",
       "      <td>0.74554</td>\n",
       "      <td>-120.4400</td>\n",
       "      <td>-0.17905</td>\n",
       "      <td>-0.154930</td>\n",
       "      <td>-0.26018</td>\n",
       "      <td>1.17490</td>\n",
       "      <td>-0.326590</td>\n",
       "      <td>...</td>\n",
       "      <td>0.148880</td>\n",
       "      <td>0.548240</td>\n",
       "      <td>0.85112</td>\n",
       "      <td>-0.522430</td>\n",
       "      <td>9.8526</td>\n",
       "      <td>3.4892</td>\n",
       "      <td>207.870</td>\n",
       "      <td>1.7559</td>\n",
       "      <td>9.95270</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5908</th>\n",
       "      <td>-0.108860</td>\n",
       "      <td>0.74394</td>\n",
       "      <td>0.015449</td>\n",
       "      <td>1.08780</td>\n",
       "      <td>-17.0030</td>\n",
       "      <td>-0.10886</td>\n",
       "      <td>-0.109180</td>\n",
       "      <td>0.12531</td>\n",
       "      <td>0.84516</td>\n",
       "      <td>0.093224</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.183200</td>\n",
       "      <td>-1.167700</td>\n",
       "      <td>1.18320</td>\n",
       "      <td>6.092400</td>\n",
       "      <td>13.8860</td>\n",
       "      <td>6.0769</td>\n",
       "      <td>83.122</td>\n",
       "      <td>4.3911</td>\n",
       "      <td>0.95575</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5909</th>\n",
       "      <td>-0.105370</td>\n",
       "      <td>0.53629</td>\n",
       "      <td>-0.045578</td>\n",
       "      <td>0.91478</td>\n",
       "      <td>-56.0680</td>\n",
       "      <td>-0.10537</td>\n",
       "      <td>-0.109940</td>\n",
       "      <td>0.86460</td>\n",
       "      <td>0.95040</td>\n",
       "      <td>0.463670</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.052186</td>\n",
       "      <td>-0.227250</td>\n",
       "      <td>1.05220</td>\n",
       "      <td>0.003196</td>\n",
       "      <td>7.7332</td>\n",
       "      <td>4.7174</td>\n",
       "      <td>136.850</td>\n",
       "      <td>2.6672</td>\n",
       "      <td>2.79270</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>43405 rows × 65 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      X01_net_profit_div_total_assets  X02_total_liabilities_div_total_assets  \\\n",
       "0                            0.200550                                 0.37951   \n",
       "1                            0.209120                                 0.49988   \n",
       "2                            0.248660                                 0.69592   \n",
       "3                            0.081483                                 0.30734   \n",
       "4                            0.187320                                 0.61323   \n",
       "...                               ...                                     ...   \n",
       "5905                         0.012898                                 0.70621   \n",
       "5906                        -0.578050                                 0.96702   \n",
       "5907                        -0.179050                                 1.25530   \n",
       "5908                        -0.108860                                 0.74394   \n",
       "5909                        -0.105370                                 0.53629   \n",
       "\n",
       "      X03_working_capital_div_total_assets  \\\n",
       "0                                 0.396410   \n",
       "1                                 0.472250   \n",
       "2                                 0.267130   \n",
       "3                                 0.458790   \n",
       "4                                 0.229600   \n",
       "...                                    ...   \n",
       "5905                              0.038857   \n",
       "5906                             -0.800850   \n",
       "5907                             -0.275990   \n",
       "5908                              0.015449   \n",
       "5909                             -0.045578   \n",
       "\n",
       "      X04_current_assets_div_shortterm_liabilities  \\\n",
       "0                                          2.04720   \n",
       "1                                          1.94470   \n",
       "2                                          1.55480   \n",
       "3                                          2.49280   \n",
       "4                                          1.40630   \n",
       "...                                            ...   \n",
       "5905                                       1.17220   \n",
       "5906                                       0.16576   \n",
       "5907                                       0.74554   \n",
       "5908                                       1.08780   \n",
       "5909                                       0.91478   \n",
       "\n",
       "      X05_cash_plus_shortterm_securities_plus_receivables_minus_shortterm_liabilities_div_operating_expenses_minus_depreciation__times_365  \\\n",
       "0                                               32.3510                                                                                      \n",
       "1                                               14.7860                                                                                      \n",
       "2                                               -1.1523                                                                                      \n",
       "3                                               51.9520                                                                                      \n",
       "4                                               -7.3128                                                                                      \n",
       "...                                                 ...                                                                                      \n",
       "5905                                           -18.9070                                                                                      \n",
       "5906                                           -67.3650                                                                                      \n",
       "5907                                          -120.4400                                                                                      \n",
       "5908                                           -17.0030                                                                                      \n",
       "5909                                           -56.0680                                                                                      \n",
       "\n",
       "      X06_retained_earnings_div_total_assets  X07_EBIT_div_total_assets  \\\n",
       "0                                    0.38825                   0.249760   \n",
       "1                                    0.00000                   0.258340   \n",
       "2                                    0.00000                   0.309060   \n",
       "3                                    0.14988                   0.092704   \n",
       "4                                    0.18732                   0.187320   \n",
       "...                                      ...                        ...   \n",
       "5905                                 0.00000                   0.013981   \n",
       "5906                                -0.57805                  -0.578050   \n",
       "5907                                -0.17905                  -0.154930   \n",
       "5908                                -0.10886                  -0.109180   \n",
       "5909                                -0.10537                  -0.109940   \n",
       "\n",
       "      X08_book_value_of_equity_div_total_liabilities  \\\n",
       "0                                            1.33050   \n",
       "1                                            0.99601   \n",
       "2                                            0.43695   \n",
       "3                                            1.86610   \n",
       "4                                            0.63070   \n",
       "...                                              ...   \n",
       "5905                                         0.41600   \n",
       "5906                                        -0.40334   \n",
       "5907                                        -0.26018   \n",
       "5908                                         0.12531   \n",
       "5909                                         0.86460   \n",
       "\n",
       "      X09_sales_div_total_assets  X10_equity_div_total_assets  ...  \\\n",
       "0                        1.13890                     0.504940  ...   \n",
       "1                        1.69960                     0.497880  ...   \n",
       "2                        1.30900                     0.304080  ...   \n",
       "3                        1.05710                     0.573530  ...   \n",
       "4                        1.15590                     0.386770  ...   \n",
       "...                          ...                          ...  ...   \n",
       "5905                     1.67680                     0.293790  ...   \n",
       "5906                     0.93979                    -0.390040  ...   \n",
       "5907                     1.17490                    -0.326590  ...   \n",
       "5908                     0.84516                     0.093224  ...   \n",
       "5909                     0.95040                     0.463670  ...   \n",
       "\n",
       "      X56__sales_minus_cost_of_products_sold__div_sales  \\\n",
       "0                                              0.121960   \n",
       "1                                              0.121300   \n",
       "2                                              0.241140   \n",
       "3                                              0.054015   \n",
       "4                                              0.134850   \n",
       "...                                                 ...   \n",
       "5905                                           0.020169   \n",
       "5906                                          -0.064073   \n",
       "5907                                           0.148880   \n",
       "5908                                          -0.183200   \n",
       "5909                                          -0.052186   \n",
       "\n",
       "      X57__current_assets_minus_inventory_minus_shortterm_liabilities__div__sales_minus_gross_profit_minus_depreciation_  \\\n",
       "0                                              0.397180                                                                    \n",
       "1                                              0.420020                                                                    \n",
       "2                                              0.817740                                                                    \n",
       "3                                              0.142070                                                                    \n",
       "4                                              0.484310                                                                    \n",
       "...                                                 ...                                                                    \n",
       "5905                                           0.043904                                                                    \n",
       "5906                                           1.482000                                                                    \n",
       "5907                                           0.548240                                                                    \n",
       "5908                                          -1.167700                                                                    \n",
       "5909                                          -0.227250                                                                    \n",
       "\n",
       "      X58_total_costs_div_total_sales  X59_longterm_liabilities_div_equity  \\\n",
       "0                             0.87804                             0.001924   \n",
       "1                             0.85300                             0.000000   \n",
       "2                             0.76599                             0.694840   \n",
       "3                             0.94598                             0.000000   \n",
       "4                             0.86515                             0.124440   \n",
       "...                               ...                                  ...   \n",
       "5905                          1.01220                             1.259400   \n",
       "5906                          1.06410                            -0.018084   \n",
       "5907                          0.85112                            -0.522430   \n",
       "5908                          1.18320                             6.092400   \n",
       "5909                          1.05220                             0.003196   \n",
       "\n",
       "      X60_sales_div_inventory  X61_sales_div_receivables  \\\n",
       "0                      8.4160                     5.1372   \n",
       "1                      4.1486                     3.2732   \n",
       "2                      4.9909                     3.9510   \n",
       "3                      4.5746                     3.6147   \n",
       "4                      6.3985                     4.3158   \n",
       "...                       ...                        ...   \n",
       "5905                  13.4720                    12.4320   \n",
       "5906                 110.7200                    44.7590   \n",
       "5907                   9.8526                     3.4892   \n",
       "5908                  13.8860                     6.0769   \n",
       "5909                   7.7332                     4.7174   \n",
       "\n",
       "      X62__shortterm_liabilities_times_365__div_sales  \\\n",
       "0                                              82.658   \n",
       "1                                             107.350   \n",
       "2                                             134.270   \n",
       "3                                              86.435   \n",
       "4                                             127.210   \n",
       "...                                               ...   \n",
       "5905                                           49.117   \n",
       "5906                                           81.220   \n",
       "5907                                          207.870   \n",
       "5908                                           83.122   \n",
       "5909                                          136.850   \n",
       "\n",
       "      X63_sales_div_shortterm_liabilities  X64_sales_div_fixed_assets  \\\n",
       "0                                  4.4158                     7.42770   \n",
       "1                                  3.4000                    60.98700   \n",
       "2                                  2.7185                     5.20780   \n",
       "3                                  4.2228                     5.54970   \n",
       "4                                  2.8692                     7.89800   \n",
       "...                                   ...                         ...   \n",
       "5905                               7.4313                     2.27990   \n",
       "5906                               4.4940                     5.13050   \n",
       "5907                               1.7559                     9.95270   \n",
       "5908                               4.3911                     0.95575   \n",
       "5909                               2.6672                     2.79270   \n",
       "\n",
       "      Y_bankrupt  \n",
       "0              0  \n",
       "1              0  \n",
       "2              0  \n",
       "3              0  \n",
       "4              0  \n",
       "...          ...  \n",
       "5905           1  \n",
       "5906           1  \n",
       "5907           1  \n",
       "5908           1  \n",
       "5909           1  \n",
       "\n",
       "[43405 rows x 65 columns]"
      ]
     },
     "execution_count": 170,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.drop(columns=data.columns[data.dtypes=='object'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Daniel\\anaconda3\\lib\\site-packages\\ipykernel_launcher.py:1: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.\n",
      "  \"\"\"Entry point for launching an IPython kernel.\n"
     ]
    }
   ],
   "source": [
    "def clean_na(data, cols=pd.Series(), real=True):\n",
    "    \n",
    "    if cols.empty:\n",
    "        na_series = data.isna().sum()\n",
    "        dropped_cols = na_series[na_series>data.shape[0]/100].axes[0]\n",
    "        clean_col = data.drop(bigna, axis=1)\n",
    "    else:\n",
    "        clean_col = data.drop(cols, axis=1)\n",
    "        dropped_cols = cols\n",
    "    \n",
    "    if real:\n",
    "        clean_col = clean_col.drop(columns=clean_col.columns[clean_col.dtypes=='object'])\n",
    "    \n",
    "    clean_na = clean_col.dropna()\n",
    "    \n",
    "    \n",
    "    \n",
    "    print(\"Columns dropped:\", dropped_cols)\n",
    "    print(\"Percentage of dropped observations\",-(clean_na.shape[0]-data.shape[0])/data.shape[0])\n",
    "    return [clean_na, dropped_cols]\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns dropped: Index(['X21_sales__n__div_sales__n_minus_1_',\n",
      "       'X24_gross_profit__in_3_years__div_total_assets',\n",
      "       'X27_profit_on_operating_activities_div_financial_expenses',\n",
      "       'X28_working_capital_div_fixed_assets',\n",
      "       'X37__current_assets_minus_inventories__div_longterm_liabilities',\n",
      "       'X41_total_liabilities_div___profit_on_operating_activities_plus_depreciation__times__12_div_365__',\n",
      "       'X45_net_profit_div_inventory', 'X53_equity_div_fixed_assets',\n",
      "       'X54_constant_capital_div_fixed_assets', 'X60_sales_div_inventory',\n",
      "       'X64_sales_div_fixed_assets'],\n",
      "      dtype='object')\n",
      "Percentage of dropped observations 0.01612717428867642\n",
      "Columns dropped: Index(['X21_sales__n__div_sales__n_minus_1_',\n",
      "       'X24_gross_profit__in_3_years__div_total_assets',\n",
      "       'X27_profit_on_operating_activities_div_financial_expenses',\n",
      "       'X28_working_capital_div_fixed_assets',\n",
      "       'X37__current_assets_minus_inventories__div_longterm_liabilities',\n",
      "       'X41_total_liabilities_div___profit_on_operating_activities_plus_depreciation__times__12_div_365__',\n",
      "       'X45_net_profit_div_inventory', 'X53_equity_div_fixed_assets',\n",
      "       'X54_constant_capital_div_fixed_assets', 'X60_sales_div_inventory',\n",
      "       'X64_sales_div_fixed_assets'],\n",
      "      dtype='object')\n",
      "Percentage of dropped observations 0.013367174280879865\n"
     ]
    }
   ],
   "source": [
    "cleaned = clean_na(data)\n",
    "clean_data = cleaned[0]\n",
    "test = clean_na(year5,cleaned[1])[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train = clean_data.drop(clean_data.columns[-1], axis=1)\n",
    "y_train = clean_data.iloc[:,[-1]]\n",
    "X_test = test.drop(test.columns[-1], axis=1)\n",
    "y_test = test.iloc[:,[-1]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Daniel\\AppData\\Roaming\\Python\\Python37\\site-packages\\sklearn\\ensemble\\_gb.py:1454: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n",
      "  y = column_or_1d(y, warn=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.9537524879990633"
      ]
     },
     "execution_count": 174,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clf = GradientBoostingClassifier(n_estimators=100, learning_rate=1.0, max_depth=1, random_state=0).fit(X_train, y_train)\n",
    "clf.score(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.94      1.00      0.97      5427\n",
      "           1       0.86      0.08      0.15       404\n",
      "\n",
      "    accuracy                           0.94      5831\n",
      "   macro avg       0.90      0.54      0.56      5831\n",
      "weighted avg       0.93      0.94      0.91      5831\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test, clf.predict(X_test)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Y_bankrupt    0.069285\n",
       "dtype: float64"
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_test.mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
